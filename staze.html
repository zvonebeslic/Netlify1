<!DOCTYPE html>
<html lang="hr">
  
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mountain Adventures</title>
  
  <!-- === SEO OPIS (HR VERZIJA) === -->
  <meta name="description" content="Istraži planinarske staze Balkana. Detaljni opisi planinarskih tura. Planinarska oprema. GPS tragovi za planinarenje. Inspirativne i poučne planinarske priče. Planinarski svijet na jednom mjestu. Planinarske staze Velebita. Planinarske staze Nacionalni park Paklenica. Planinarske staze Nacionalni park Triglav. Planinarske staze Nacionalni park Sutjeska. Planinarske staze Nacionalni park Prokletije. Planinarske staze Nacionalni park Durmitor. Planinarske staze Nacionalni park Biogradska gora. Planinarske staze Nacionalni park Plitvička jezera. Planinarske staze Nacionalni park Sjeverni Velebit. Planinarske staze Nacionalni park Risnjak. Planinarske staze Nacionalni park Tara. Planinarske staze Nacionalni park Kopaonik. Planinarske staze Nacionalni park Đerdap. Planinarske staze Nacionalni park Mavrovo. Planinarske staze Nacionalni park Galicica. Planinarske staze Nacionalni park Pelister. Planinarske staze Julijske Alpe. Planinarske staze Nacionalni park Logarska dolina. Planinarske staze Park prirode Blidinje. Planinarske staze Prenj. Planinarske staze Park prirode Biokovo. Planinarske staze Komovi. Planinarske staze Rila. Planinarske staze Čvrsnica. Planinarske staze Hrvatske, Planinarske staze Bosne i Hercegovine, Planinarske staze Albanije, Planinarske staze Slovenije, Planinarske staze Makedonije, Planinarske staze Crne Gore i Planinarske staze Srbije.">
      
  <!-- === CANONICAL I HREFLANG === -->
  <link rel="canonical" href="https://tvojadomena.com/" />
  <link rel="alternate" hreflang="hr" href="https://tvojadomena.com/" />
  <link rel="alternate" hreflang="en" href="https://tvojadomena.com/index-en.html" />
  <link rel="alternate" hreflang="x-default" href="https://tvojadomena.com/" />
      
  <!-- === OPEN GRAPH (HR + EN) === -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://tvojadomena.com/" />
  <meta property="og:image" content="https://tvojadomena.com/images/cover.jpg" />

  <meta property="og:title" content="Mountain Adventures – Planinarske staze Balkana" />
  <meta property="og:description" content="Planinarske staze, GPS tragovi, planinarska oprema i inspirativne priče. Istraži Velebit, Durmitor, Prokletije i druge planine Balkana." />

  <meta property="og:title" lang="en" content="Mountain Adventures – Balkan Hiking Trails" />
  <meta property="og:description" lang="en" content="Hiking trails, GPS tracks, hiking gear and inspiring stories. Explore Velebit, Durmitor, Prokletije and other Balkan mountains." />

  <!-- === TWITTER CARDS (HR + EN) === -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://tvojadomena.com/images/cover.jpg" />

  <meta name="twitter:title" content="Mountain Adventures – Planinarske staze Balkana" />
  <meta name="twitter:description" content="Istraži planinarske staze Balkana. Detaljni opisi planinarskih tura. Planinarska oprema. GPS tragovi za planinarenje. Inspirativne i poučne planinarske priče. Planinarski svijet na jednom mjestu." />

  <meta name="twitter:title" lang="en" content="Mountain Adventures – Balkan Hiking Trails" />
  <meta name="twitter:description" lang="en" content="Explore the hiking trails of the Balkans. Detailed descriptions of hiking tours. Hiking gear. GPS tracks for hiking. Inspiring and educational hiking stories. The hiking world in one place." />

  <!-- === Ikona za spremanje sadrzaja na mobitele === -->
  <link rel="icon" href="images/mountain-adventures.svg" type="image/svg+xml" />
      
  <!-- === Link za fontove u naslovnoj slici === -->
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />

  <!-- === SEASON STILOVI === -->
  <link rel="stylesheet" href="season.css" />   
      
  <style>
       /* === OSNOVNI RESET I GLOBALNA PRAVILA === */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  overflow-x: hidden;
  scroll-behavior: smooth;
  background-color: #000;
}

/* === NAVIGACIJA / GORNJI IZBORNIK === */
.navbar {
  position: fixed;
  top: 0;
  width: 100%;
  height: 70px;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 15px;
  z-index: 1000;
}

/* === ZASTAVICA (tooltip na hover) === */
.navbar-left img {
  height: 16px;
  width: 24px;
  cursor: pointer;
  position: relative;
}

.navbar-left img:hover::after {
  content: attr(data-tooltip);
  position: absolute;
  background: #fff;
  color: #000;
  padding: 4px 8px;
  border-radius: 5px;
  font-size: 12px;
  top: 30px;
  left: 0;
  white-space: nowrap;
  box-shadow: 0 0 6px rgba(0,0,0,0.2);
}

/* === TRAŽILICA (CENTAR) === */
.navbar-center {
  flex: 1;
  display: flex;
  justify-content: center;
  z-index: 1;
  transform: translateY(12px);
}

.search-container {
  width: 250px;
  position: relative;
  padding-top: 10px;
  z-index: 1;
}

.search-wrapper {
  position: relative;
  z-index: 2;
  width: 100%;
  height: 30px; /* ili 55px ako dodaješ prostor za sliku */
  background: #fff;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
  padding: 0 15px;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  overflow: visible;
  border-radius: 20px;
}

/* === UKRASNA PLANINA IZNAD TRAŽILICE === */
.search-top-decoration {
  position: absolute;
  top: -212.7px;
  left: 108px;
  width: 1600%;
  height: 30px;
  object-fit: cover;
  display: block;
  z-index: -10;
  transform: scale(19);
  transform-origin: top center;
  pointer-events: none;
}
      
/* === UNUTARNJI INPUT POLJE === */
.mountain-search {
  width: 100%;
  padding: 14px 40px 8px 12px;
  font-size: 14px;
  border: none;
  background: transparent;
  color: #333;
  outline: none;
}

/* === IKONA UNUTAR TRAŽILICE === */
.search-wrapper img {
  position: absolute;
  right: 12px;
  bottom: 8px;
  width: 19px;
  height: 19px;
  pointer-events: none;
}

/* === DESNA STRANA (HAMBURGER IKONA) === */
.navbar-right {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 5px;
  padding: 8px;
  border: 1px solid rgba(255, 255, 255, 0.4);
  border-radius: 8px;
  cursor: pointer;
  background: rgba(255, 255, 255, 0.05);
  transition: background 0.3s, transform 0.2s;
}

.navbar-right:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.05);
}

.burger-line {
  width: 26px;
  height: 3px;
  background-color: white;
  border-radius: 2px;
}

/* === MENI KOJI SE OTVARA === */
.menu-overlay {
  position: fixed;
  top: 70px;
  right: 0;
  width: 35vw;
  background-color: rgba(17, 17, 17, 0.95);
  color: white;
  padding: 20px;
  display: none;
  flex-direction: column;
  align-items: flex-start;
  z-index: 9999;
}

.menu-overlay.open {
  display: flex;
}

.menu-overlay a {
  margin: 10px 0;
  text-decoration: none;
  color: white;
  font-size: 1.1em;
}
    
.section {
  height: 50vh;
  overflow: hidden;
  position: relative;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  transition: transform 1s ease, opacity 1s ease;
}

/* === SEKCIJA KOJA JE VIDLJIVA U VIEWPORTU === */
.section.visible {
  opacity: 1;
  transform: scale(1.05);
  z-index: 2;
}

/* === SEKCIJE KOJE NISU U FOKUSU === */
.section:not(.visible) {
  opacity: 0.4;
  transform: scale(1);
}
    
.trail-list {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  justify-content: center;
}
    
.trail-card {
  width: 300px;
  border: 1px solid #ccc;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  background-color: #fafafa;  
  transition: transform 0.2s ease;
}
    
.trail-card:hover {
  transform: scale(1.02);
}
    
.trail-card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}
    
.trail-card div {
  padding: 1rem;
}
    
.trail-card h3 {
  margin-top: 0;
}
   
#trail-filter-form {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  justify-content: center;
  margin: 1rem 0 2rem;
}
    
#trail-filter-form select,
#trail-filter-form button {
  padding: 0.5rem 1rem;
  border-radius: 5px;
  border: 1px solid #888;
  font-size: 1rem;
}
    
#trail-filter-form button {
  background-color: #35776a;
  color: #fff;
  cursor: pointer;
}
    
#trail-filter-form button:hover {
  background-color: #26594f;
}

   /* === GUMB "NA VRH STRANICE" (BACK TO TOP) === */
#backToTop {
  position: fixed;
  bottom: 22px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 9999;
  background: rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(12px);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.3);
  outline: none;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  cursor: pointer;
  display: none;
  align-items: center;
  justify-content: center;
  transition: background 0.3s ease, transform 0.3s ease;
}

#backToTop:hover {
  background-color: rgba(255, 255, 255, 0.3);
  transform: translateX(-50%) scale(1.1);
}

#backToTop svg {
  width: 24px;
  height: 24px;
}

/* === FOOTER === */
footer {
  background: #111;
  color: #ccc;
  text-align: center;
  padding: 20px 10px;
  font-size: 14px;
  position: relative;
  margin-top: 60px;
}

.footer-icons {
  margin: 10px 0;
}

.footer-icons svg {
  width: 32px;
  height: 32px;
  margin: 0 10px;
  vertical-align: middle;
  opacity: 0.8;
  transition: opacity 0.3s, transform 0.3s;
}

.footer-icons svg:hover {
  opacity: 1;
  transform: scale(1.1);
}

 /* === OPĆI EFEKT PRITISKA (UNIVERZALNA KLASA .pressed) === */
.pressed {
  transform: scale(0.97);
  transition: transform 0.15s ease;
}

/* === UNUTARNJI SLOJ I TEKST (KUTIJA SADRŽAJA) === */
.content-box {
  overflow: hidden;
  position: relative; /* ili absolute ako već pozicioniraš sekcije */
}   

 /* === DODATNI INTERAKTIVNI ELEMENTI: ZASTAVICE, IKONE, GUMBI === */
.lang-flag {
  transition: transform 0.15s ease, background-color 0.2s ease, filter 0.2s ease;
  cursor: pointer;
  transform-origin: center center;
}

/* === HOVER EFEKT ZA GORENJE ELEMENTE === */
.lang-flag:hover {
  filter: brightness(1.1);
  background-color: rgba(255, 255, 255, 0.15);
  color: #fff;
}
      
/* === SPRIJEČAVANJE ŠIRENJA VAN EKRANA === */
html, body {
  overflow-x: hidden !important;
}

/* === FILTER UI (NOVO) === */
.filters { padding: 12px; background: rgba(255,255,255,.7); border-radius: 12px; backdrop-filter: blur(6px); margin: 16px; }
.filter-row { display: grid; gap: 10px; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); margin-bottom: 10px; }
.filters label, .filters fieldset { display: flex; flex-direction: column; gap: 6px; font-size: 14px; }
.difficulty { border: 1px solid #cfd8dc; border-radius: 10px; padding: 10px; background: #fff; }
.difficulty legend { padding: 0 6px; font-weight: 600; }
.difficulty .mode { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
.difficulty .chips { display: flex; flex-wrap: wrap; gap: 10px; }
#applyFilters, #clearFilters { padding: 10px 14px; border-radius: 8px; border: 1px solid #888; font-weight: 600; background: #35776a; color: #fff; cursor: pointer; }
#clearFilters { background: #6b7b83; }
#applyFilters:hover, #clearFilters:hover { filter: brightness(1.05); }

/* === BADGEOVI NA KARTICAMA (NOVO) === */
.badges { display: flex; gap: 6px; margin-top: 6px; flex-wrap: wrap; }
.badge { font-size: 12px; padding: 4px 8px; border-radius: 999px; background: #f0f2f4; }
.badge.km { background: #e7f3ff; }
.badge.elev { background: #eaf9ec; }
.badge.poi { background: #f6eefc; }
.badge.very-easy { color:#0b6; }
.badge.easy { color:#2a8; }
.badge.medium { color:#c90; }
.badge.hard { color:#d55; }
.badge.extreme { color:#b00; }
  </style>
</head>
  
<body>
  <div id="season-placeholder"></div>

  <!-- === NAVIGACIJA (gore) === -->
  <div class="navbar">
    <div class="navbar-left">
      <img src="images/flag-uk.svg" alt="promjena jezika na engleski" id="language-toggle" data-tooltip="Promijeni jezik">
    </div>
    <div class="navbar-center">
      <div class="search-container">
        <div class="search-wrapper">
          <img src="images/planine-za-trazilicu.png" alt="planinski-vrhovi" class="search-top-decoration" />
          <input type="text" class="mountain-search" id="search" placeholder="Pretraži...">
          <img src="images/search.svg" alt="ikona za tražilicu">
        </div>
      </div>
    </div>
    <div class="navbar-right" id="menu-toggle">
      <div class="burger-line"></div>
      <div class="burger-line"></div>
      <div class="burger-line"></div>
    </div>
  </div>

  <!-- === HAMBURGER MENI === -->
  <div class="menu-overlay" id="menu">
    <a href="index.html" data-hr="Naslovna" data-en="Home">Naslovna</a>
    <a href="staze.html" data-hr="Staze" data-en="Trails">Staze</a>
    <a href="avantura.html" data-hr="Avantura" data-en="Adventure">Avantura</a>
    <a href="webshop.html" data-hr="Web shop" data-en="Web Shop">Web shop</a>
    <a href="planinarskevijesti.html" data-hr="Blog" data-en="Blog">Blog</a>
    <a href="digitalniruksak.html" data-hr="Digitalni ruksak" data-en="Digital backpack">Digitalni ruksak</a>
    <a href="kontakt.html" data-hr="Kontakt" data-en="Contact">Kontakt</a>
  </div>

  <section class="image-section" style="background-image: url('images/hero.jpg'); height: 50vh;">
    <div class="overlay"></div>
  </section>

  <main>
    <section style="background-color: #f8f8f8; text-align: center;">
      <h1>Istraži planinarske staze Balkana</h1>
      <p>Filtriraj i pronađi savršenu rutu prema težini, planini, trajanju ili tvojoj lokaciji.</p>
    </section>

    <!-- === FILTRI (NOVO) === -->
    <section style="background-color: #e3ecec;">
      <h2 style="text-align: center;">Filtriraj staze</h2>

      <section id="trail-filters" class="filters">
        <div class="filter-row">
          <label>
            Planina/Područje
            <select id="areaSelect">
              <option value="">Sve lokacije</option>
              <option>Triglav</option>
              <option>Velebit</option>
              <option>Begunjščica</option>
              <option>Klekovača</option>
              <option>Sljeme</option>
              <option>Medvednica</option>
              <option>Dinara</option>
              <option>Oštrovača</option>
              <option>Šator</option>
              <option>Kozara</option>
              <option>Ivanščica</option>
              <option>Kamešnica</option>
              <option>Cincar</option>
              <option>Vranica</option>
              <option>Matinski Vis</option>
              <option>Zavelim</option>
              <option>Golija</option>
              <option>Stožer</option>
              <option>Ljubuša</option>
              <option>Tušnica</option>
              <option>Svilaja</option>
              <option>Biokovo</option>
              <option>Mosor</option>
              <option>Raduša</option>
              <option>Vran</option>
              <option>Čvrsnica</option>
              <option>Čabulja</option>
              <option>Prenj</option>
              <option>Crvanj</option>
              <option>Matokit</option>
              <option>Velež</option>
              <option>Visočica</option>
              <option>Bjelašnica</option>
              <option>Treskavica</option>
              <option>Zelengora</option>
              <option>Volujak</option>
              <option>Maglić</option>
              <option>Lelija</option>
              <option>Durmitor</option>
              <option>Komovi</option>
              <option>Prokletije</option>
              <option>Šar planina</option>
              <option>Otok Pag</option>
              <option>Poluotok Pelješac</option>
              <option>Šipovo</option>
              <option>Otok Hvar</option>
              <option>Otok Brač</option>
              <option>Kanjon Badnjevice</option>
              <option>Oštrc</option>
            </select>
          </label>

          <label>
            Udaljenost od mene
            <select id="radiusSelect" title="Zatražit će se tvoja lokacija pri prvom odabiru">
              <option value="">Bez ograničenja</option>
              <option value="100">Do 100 km</option>
              <option value="200">Do 200 km</option>
              <option value="300">Do 300 km</option>
              <option value="400">Do 400 km</option>
              <option value="500">Do 500 km</option>
            </select>
          </label>

          <label>
            Trajanje (hodanje)
            <select id="durationBucket">
              <option value="">Bilo koje</option>
              <option value="3">Do 3 h</option>
              <option value="5">Do 5 h</option>
              <option value="8">Do 8 h</option>
              <option value="10">Do 10 h</option>
              <option value=">10">Preko 10 h</option>
            </select>
          </label>
        </div>

        <fieldset class="difficulty">
          <legend>Težina</legend>
          <div class="mode">
            <label><input type="checkbox" id="modeKm" checked> po km</label>
            <label><input type="checkbox" id="modeElev" checked> po usponu</label>
            <select id="difficultyLogic" title="Kombiniraj po km/uspon">
              <option value="any" selected>Poklopi bilo koju</option>
              <option value="all">Poklopi obje</option>
            </select>
          </div>
          <div class="chips">
            <label><input type="checkbox" class="diff-chip" value="very-easy"> Jako lako</label>
            <label><input type="checkbox" class="diff-chip" value="easy"> Lako</label>
            <label><input type="checkbox" class="diff-chip" value="medium" checked> Srednje teško</label>
            <label><input type="checkbox" class="diff-chip" value="hard"> Jako teško</label>
            <label><input type="checkbox" class="diff-chip" value="extreme"> Ekstremno</label>
          </div>
        </fieldset>

        <div class="filter-row">
          <label style="grid-column: 1 / -1;">
            Tražilica odredišta (vrh/mjesto)
            <input id="poiSearch" type="search" placeholder="npr. Hajdučka Vrata">
          </label>

          <button id="applyFilters" type="button">Primijeni</button>
          <button id="clearFilters" type="button">Reset</button>
        </div>
      </section>
    </section>

    <!-- === LISTA STAZA (renderira se JS-om) === -->
    <section class="trail-list" id="trail-list"></section>
  </main>

  <!-- === GUMB: VRATI NA VRH STRANICE === -->
  <button id="backToTop" title="Na vrh" aria-label="Gumb na vrh">
    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </button>

  <!-- === FOOTER === -->
  <footer id="footer">
    <div class="footer-icons">
      <a href="https://instagram.com/mountainadventures__" target="_blank" aria-label="Link za Instagram">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
          <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
          <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line>
        </svg>
      </a>
      <a href="mailto:mountainadventures1717@gmail.com" aria-label="Link za Email">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ffffff" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
      </a>
    </div>
    © Mountain Adventures. All rights reserved.
  </footer>

  <script src="season.js"></script>
      
  <script>
  // === 1. DEFINICIJE ELEMENTA ===
  const langToggle = document.getElementById('language-toggle');
  const searchInput = document.getElementById('search');
  const menuToggle = document.getElementById('menu-toggle');
  const menu = document.getElementById('menu');
  const backToTopBtn = document.getElementById('backToTop');
  const footer = document.getElementById('footer');

  // === 2. JEZIČNI TOGGLE I PREVODI ===
  function getInitialLang() {
    const urlLang = new URLSearchParams(location.search).get('lang');
    if (urlLang === 'hr' || urlLang === 'en') return urlLang;
    try {
      const saved = localStorage.getItem('preferredLang');
      if (saved === 'hr' || saved === 'en') return saved;
    } catch(e) {}
    return 'hr';
  }
  function applyLanguage(lang) {
    try { localStorage.setItem('preferredLang', lang); } catch(e) {}
    const u = new URL(location.href);
    u.searchParams.set('lang', lang);
    history.replaceState({}, '', u.toString());
    document.documentElement.lang = lang;

    if (langToggle) {
      langToggle.src = lang === 'hr' ? 'images/flag-uk.svg' : 'images/flag-hr.svg';
      langToggle.alt = lang === 'hr' ? 'Promijeni na engleski' : 'Switch to Croatian';
      langToggle.setAttribute('data-tooltip', lang === 'hr' ? 'Promijeni jezik' : 'Change language');
    }
    if (searchInput) {
      searchInput.placeholder = lang === 'hr' ? 'Pretraži...' : 'Search...';
    }
    document.querySelectorAll('[data-hr]').forEach(el => {
      const htmlContent = el.getAttribute(`data-${lang}`);
      if (htmlContent == null) return;
      if (htmlContent.includes('<')) el.innerHTML = htmlContent;
      else el.textContent = htmlContent;
    });
    document.querySelectorAll('.menu-overlay a').forEach(link => {
      const txt = link.getAttribute(`data-${lang}`);
      if (txt != null) link.textContent = txt;
    });
  }
  let currentLang = getInitialLang();
  applyLanguage(currentLang);
  if (langToggle) {
    langToggle.addEventListener('click', () => {
      currentLang = currentLang === 'hr' ? 'en' : 'hr';
      applyLanguage(currentLang);
    });
  }

  // === 3. HAMBURGER MENI ===
  menuToggle.addEventListener('click', () => {
    menu.classList.toggle('open');
  });
  window.addEventListener('click', e => {
    if (!menu.contains(e.target) && !menuToggle.contains(e.target) && e.target.id !== 'language-toggle') {
      menu.classList.remove('open');
    }
  });
  document.querySelectorAll('.menu-overlay a').forEach(link => {
    link.addEventListener('click', () => { menu.classList.remove('open'); });
  });

  // === 4. PARALLAX SEKCIJE ===
  const sections = document.querySelectorAll('.section');  
  const observer = new IntersectionObserver(entries => {  
    entries.forEach(entry => {  
      entry.isIntersecting ? entry.target.classList.add('visible') : entry.target.classList.remove('visible');  
    });  
  }, { threshold: 0.52 });  
  sections.forEach(section => observer.observe(section));

  // === 5. BACK TO TOP GUMB ===
  window.addEventListener('scroll', () => {
    const scrollY = window.scrollY;
    const footerTop = footer.getBoundingClientRect().top + window.scrollY;
    const windowHeight = window.innerHeight;

    backToTopBtn.style.display = scrollY > 300 ? 'flex' : 'none';
    backToTopBtn.style.bottom = (scrollY + windowHeight > footerTop)
      ? `${(scrollY + windowHeight - footerTop) + 60}px`
      : '30px';
  });
  backToTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  // === 6. EFEKT PRITISKA NA ZASTAVICU ===
  document.querySelectorAll('.lang-flag').forEach(el => {
    el.addEventListener('click', e => {
      const link = el.querySelector('a');
      const href = link ? link.getAttribute('href') : null;
      if (href) {
        e.preventDefault();
        el.classList.add('pressed');
        setTimeout(() => {
          el.classList.remove('pressed');
          window.location.href = href;
        }, 150);
      }
    });
  });

  // === 7. SEASON HTML I EFEKTI (dinamički dio)
  document.addEventListener("DOMContentLoaded", () => {
    const savedSeason = localStorage.getItem("activeSeason");
    if (savedSeason) {
      setTimeout(() => {
        if (savedSeason === "winter") startWinterEffect(true);
        else if (savedSeason === "summer") startSummerEffect(true);
        else if (savedSeason === "spring") startSpringEffect(true);
        else if (savedSeason === "autumn") startAutumnEffect(true);
      }, 10000);
    }
    fetch("season.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("season-placeholder").innerHTML = html;
        if (typeof initializeSeasonToggle === 'function') initializeSeasonToggle();
      });
  });

  /* === TRAILS + FILTER LOGIKA (NOVO) === */

  // Demo podaci — u praksi učitaj iz JSON-a/CMS-a. Bitno: startLat/startLon + destinations[].
  const TRAILS = [
    { id:1, name:"Premužićeva staza", area:"Velebit", mountain:"Velebit",
      distanceKm: 9, elevationM: 180, durationH: 3.5,
      startLat: 44.737, startLon: 15.028, destinations:["Zavižan","Rossijevo sklonište"] },

    { id:2, name:"Uspon na Triglav", area:"Triglav", mountain:"Triglav",
      distanceKm: 12, elevationM: 1100, durationH: 8,
      startLat: 46.379, startLon: 13.836, destinations:["Triglav"] },

    { id:3, name:"Hajdučka Vrata", area:"Čvrsnica", mountain:"Čvrsnica",
      distanceKm: 15, elevationM: 950, durationH: 7.5,
      startLat: 43.540, startLon: 17.561, destinations:["Hajdučka Vrata"] },

    { id:4, name:"Maja Jezerce", area:"Prokletije", mountain:"Prokletije",
      distanceKm: 22, elevationM: 1700, durationH: 11,
      startLat: 42.441, startLon: 19.812, destinations:["Maja Jezerce"] }
  ];

  // Klasifikacija težine po km i usponu
  const DIFF_LABELS = {
    "very-easy":"Jako lako","easy":"Lako","medium":"Srednje teško","hard":"Jako teško","extreme":"Ekstremno"
  };
  function classifyByKm(km){
    if (km <= 6) return "very-easy";
    if (km <= 10) return "easy";
    if (km <= 16) return "medium";
    if (km <= 20) return "hard";
    return "extreme";
  }
  function classifyByElev(m){
    if (m <= 200) return "very-easy";
    if (m <= 500) return "easy";
    if (m <= 1000) return "medium";
    if (m <= 1500) return "hard";
    return "extreme";
  }

  // Geolokacija + Haversine
  let userLocation = null; // {lat, lon}
  function ensureGeolocationOnce() {
    return new Promise((resolve) => {
      if (userLocation) return resolve(userLocation);
      if (!('geolocation' in navigator)) return resolve(null);
      navigator.geolocation.getCurrentPosition(
        pos => { userLocation = { lat: pos.coords.latitude, lon: pos.coords.longitude }; resolve(userLocation); },
        _err => resolve(null),
        { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
      );
    });
  }
  function haversineKm(lat1, lon1, lat2, lon2) {
    const R = 6371; const toRad = d => d*Math.PI/180;
    const dLat = toRad(lat2-lat1), dLon = toRad(lon2-lon1);
    const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
    return 2 * R * Math.asin(Math.sqrt(a));
  }

  // Pomoćno
  function norm(s){
    return (s||"").toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");
  }
  function badgeEl(text, classes=[]) {
    const span = document.createElement('span');
    span.className = ['badge', ...classes].join(' ');
    span.textContent = text;
    return span;
  }

  // Render liste
  function renderTrails(list) {
    const host = document.getElementById('trail-list');
    host.innerHTML = '';
    if (!list.length) { host.innerHTML = '<p style="color:#fff; text-align:center;">Nema rezultata za odabrane filtere.</p>'; return; }

    list.forEach(t => {
      const kmDiff = classifyByKm(t.distanceKm);
      const elevDiff = classifyByElev(t.elevationM);

      let distanceInfo = '';
      if (userLocation && Number.isFinite(t.startLat) && Number.isFinite(t.startLon)) {
        const d = haversineKm(userLocation.lat, userLocation.lon, t.startLat, t.startLon);
        distanceInfo = ` • ${d.toFixed(0)} km od tebe`;
      }

      const card = document.createElement('article');
      card.className = 'trail-card';
      card.innerHTML = `
        <img src="images/hero.jpg" alt="${t.area}">
        <div>
          <h3>${t.name}</h3>
          <p><strong>Planina/Područje:</strong> ${t.area}${distanceInfo}</p>
          <p><strong>Trajanje:</strong> ${t.durationH} h</p>
          <p><strong>Udaljenost:</strong> ${t.distanceKm} km • <strong>Uspon:</strong> ${t.elevationM} m</p>
          <div class="badges"></div>
          <a href="#" style="display:inline-block; margin-top:8px;">Detalji &rarr;</a>
        </div>
      `;
      const badges = card.querySelector('.badges');
      badges.appendChild(badgeEl(`Težina (km): ${DIFF_LABELS[kmDiff]}`, ['km', kmDiff]));
      badges.appendChild(badgeEl(`Težina (uspon): ${DIFF_LABELS[elevDiff]}`, ['elev', elevDiff]));
      if (t.destinations?.length) { badges.appendChild(badgeEl(`Odredišta: ${t.destinations.join(', ')}`, ['poi'])); }

      host.appendChild(card);
    });
  }

  // Filtriranje
  async function applyTrailFilters() {
    const selArea = document.getElementById('areaSelect').value.trim();
    const radiusVal = document.getElementById('radiusSelect').value;
    const durationBucket = document.getElementById('durationBucket').value;
    const poiQuery = norm(document.getElementById('poiSearch').value);

    const modeKm = document.getElementById('modeKm').checked;
    const modeElev = document.getElementById('modeElev').checked;
    const logic = document.getElementById('difficultyLogic').value; // any | all
    const selectedDiffs = [...document.querySelectorAll('.diff-chip:checked')].map(i=>i.value);
    const diffActive = selectedDiffs.length > 0 && (modeKm || modeElev);

    if (radiusVal && !userLocation) await ensureGeolocationOnce();
    const maxDistance = radiusVal ? parseInt(radiusVal,10) : null;

    const filtered = TRAILS.filter(t => {
      // Planina/Područje
      if (selArea && t.area !== selArea) return false;

      // Udaljenost od mene
      if (maxDistance && userLocation) {
        if (!(Number.isFinite(t.startLat) && Number.isFinite(t.startLon))) return false;
        const d = haversineKm(userLocation.lat, userLocation.lon, t.startLat, t.startLon);
        if (d > maxDistance) return false;
      }

      // Trajanje (bucket)
      if (durationBucket) {
        if (durationBucket === '>10') { if (!(t.durationH > 10)) return false; }
        else { if (!(t.durationH <= Number(durationBucket))) return false; }
      }

      // Mini tražilica odredišta (vrh/mjesto)
      if (poiQuery) {
        const hay = [t.name, t.area, t.mountain, ...(t.destinations||[])].map(norm).join('|');
        if (!hay.includes(poiQuery)) return false;
      }

      // Težina
      if (diffActive) {
        const kmDiff = classifyByKm(t.distanceKm);
        const elevDiff = classifyByElev(t.elevationM);
        const kmMatch = modeKm ? selectedDiffs.includes(kmDiff) : null;
        const elevMatch = modeElev ? selectedDiffs.includes(elevDiff) : null;

        if (modeKm && modeElev) return (logic === 'all') ? (kmMatch && elevMatch) : (kmMatch || elevMatch);
        if (modeKm) return kmMatch;
        if (modeElev) return elevMatch;
      }

      return true;
    });

    renderTrails(filtered);
  }

  function clearTrailFilters() {
    document.getElementById('areaSelect').value = '';
    document.getElementById('radiusSelect').value = '';
    document.getElementById('durationBucket').value = '';
    document.getElementById('poiSearch').value = '';
    document.getElementById('modeKm').checked = true;
    document.getElementById('modeElev').checked = true;
    document.getElementById('difficultyLogic').value = 'any';
    document.querySelectorAll('.diff-chip').forEach(i => i.checked = false);
    renderTrails(TRAILS);
  }

  // Init vezivanja
  document.addEventListener('DOMContentLoaded', () => {
    renderTrails(TRAILS);

    const radius = document.getElementById('radiusSelect');
    let asked = false;
    radius.addEventListener('focus', async () => { if (!asked) { asked = true; await ensureGeolocationOnce(); }});
    radius.addEventListener('change', applyTrailFilters);

    document.getElementById('applyFilters').addEventListener('click', applyTrailFilters);
    document.getElementById('clearFilters').addEventListener('click', clearTrailFilters);
    document.getElementById('poiSearch').addEventListener('keydown', e => { if (e.key === 'Enter') applyTrailFilters(); });
  });
  </script>
</body>
</html>
